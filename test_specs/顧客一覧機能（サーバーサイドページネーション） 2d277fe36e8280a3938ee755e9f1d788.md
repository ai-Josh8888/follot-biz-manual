# 顧客一覧機能（サーバーサイドページネーション）

## 1. 基本情報

- **作成日**: 2025 年 12 月 22 日
- **対象バージョン**: リリース前最終版
- **テスト対象**: 顧客一覧のサーバーサイドページネーション機能およびクライアントモード機能
- **関連実装**:
    - src/components/environments/CustomersManager/index.tsx
    - src/hooks/useCustomer.ts
    - src/core/repositories/customerRepository.ts

## 2. 機能ごとのセクション

### 基本情報

- **URL**: /customers (顧客一覧画面)
- **コンポーネント**: src/components/environments/CustomersManager/
- **機能概要**: 顧客リストのサーバーサイドページネーション表示。特定の検索条件下ではクライアントモード（全件取得＋クライアント側ページネーション）に切り替わる。

## 3. テスト項目

### UI 表示テスト (UI)

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| CS-UI-001 | 初期表示（フィルタなし） | 登録日降順で最新 20 件が表示され、リスト下部に「続きを読む」ボタンが表示されること。 | 井上文 | 2025/12/24 | 〇 |  |
| CS-UI-002 | 件数表示 | 顧客総数が正しく表示されていること。 | 井上文 | 2025/12/24 | 〇 |  |

### 機能テスト (FUNC) - サーバーサイドモード

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| CS-FUNC-001 | 追加読み込み（もっと見る） | ボタン押下で次の 20 件がロードされ、リストに追加されること。重複表示がないこと。 | 井上文 | 2025/12/24 | 〇 |  |
| CS-FUNC-002 | 初回問い合わせ日フィルタ

期間を指定して検索 | 指定期間内の顧客のみがリセットされ最新 20 件から表示されること。 | 井上文 | 2025/12/24 | △ | [【仕様確認】検索-初回問い合わせ日フィルタ：終了日を[12月24日]として検索した場合、[12月24日]に作成したタスク/顧客等がヒットしない](https://www.notion.so/12-24-12-24-2d377fe36e828089a210d933ff37ae5b?pvs=21) |
| CS-FUNC-003 | 見込み度フィルタ

見込み度を指定 | リストがリセットされ、該当する見込み度の顧客のみが表示されること。 | 井上文 | 2025/12/24 | △ | [【BUG】顧客情報：LINEの友達登録→既存顧客&ユーザーに紐づけず直接顧客情報を作成した場合、見込み度に「0」がセットされてしまう](https://www.notion.so/BUG-LINE-0-2d377fe36e8280b1b5e9f5abd2a324aa?pvs=21) |
| CS-FUNC-004 | 担当者フィルタ適用 | 特定の担当者を選択するとリストがリセットされ、該当顧客が最新 20 件表示されること。 | 井上文 | 2025/12/24 | ✕ | [【BUG】顧客管理-検索フィルタ：[担当者]フィルタで担当者が指定できない　※他の類似チケットよりも深刻](https://www.notion.so/BUG-2d377fe36e828024bd73c6b2954814a7?pvs=21) |
| CS-FUNC-005 | ソート変更（五十音順等）

並び順を変更 | 指定順でサーバーから再取得され、ページネーションが有効であること。 | 井上文 | 2025/12/25 | △ | [【仕様確認】顧客一覧：検索フィルタ[アルファベット順][五十音順]の基準について](https://www.notion.so/2d477fe36e8280b8a9ccc8ed57c5f634?pvs=21) |
| CS-FUNC-bun01 | 利用連絡ツールフィルタ適用 | 顧客が利用しているツールがメール/LINE/ChatWork で絞れる(筈) | 井上文 | 2026/01/05 | ✕ | [【BUG】顧客管理-フィルタ検索：[利用連絡ツール]フィルタが機能していない](https://www.notion.so/BUG-2df77fe36e828062a694e05821fdd9e9?pvs=21) |

### 機能テスト (FUNC) - クライアントモード（全件取得＋クライアントページネーション）

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| CS-FUNC-006 | フリーワード検索 | 検索実行時、該当顧客が全件取得される。最初は 20 件表示され、「続きを読む」ボタン押下で次の 20 件が表示される（クライアント側ページネーション）こと。 | 井上文 | 2025/12/25 | 〇 |  |
| CS-FUNC-007 | 電話番号/住所検索 | 電話番号を入力して検索。全件取得後、最初は 20 件表示され、続きを読むボタンで追加表示（クライアント側ページネーション）されること。 | 井上文 | 2025/12/25 | △ | [【仕様確認】顧客管理-検索機能(フィルタでない)：顧客情報に登録した(顧客一覧からでも確認できる)電話番号で検索をかけてもhitしない](https://www.notion.so/hit-2d477fe36e828027bb32eb3900b91587?pvs=21) |
| CS-FUNC-008 | 対応状況ソート | 「対応状況順」を選択。全顧客が読み込まれ、ソート後に 20 件ずつ表示（続きを読むボタンで追加表示）されること。 | 井上文 | 2025/12/25 | ？ | 「対応状況順」というものが存在しない

「ルームステータス」という択があるが、何を基準にしているのかは全く分からない |
| CS-FUNC-009 | 検索条件クリア | 入力をクリアすると、再度サーバーサイドモード（最新 20 件表示＋サーバーサイドページネーション追加）に戻ること。 | 井上文 | 2025/12/25 | ？ | 検索欄をクリアする→ブランクにして検索
という認識なのか
検索欄をブランクにするだけ(自動的に対応される)でいいのか

現状だとブランクにして検索しないとページの表示は戻らない |

### パフォーマンステスト (PERF)

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
|  CS-PERF-001 | サーバーサイド取得速度 | ページ切り替え（もっと見る）

ストレスのない速度（数秒以内）で次のデータが表示されること。 | 井上文 | 2025/12/25 | ？ | 「もっと見る」というワードが入っているパーツが見当たらない |
| CS-PERF-002 | クライアントモード切替速度 | 全件取得検索を実行

データ量に応じた適切なローディング表示があり、ブラウザがフリーズしないこと（※大量データ時は遅延が予想されるため、許容範囲を確認）。 | 井上文 | 2025/12/25 | ？ | テスト方法不明 |