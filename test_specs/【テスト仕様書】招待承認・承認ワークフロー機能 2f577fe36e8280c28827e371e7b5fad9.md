# 【テスト仕様書】招待承認・承認ワークフロー機能

## 基本情報

- **作成日**: 2025 年 12 月 23 日
- **対象バージョン**: リリース前最終版
- **テスト対象**: 招待トークンの検証、アカウント作成フォーム（新規）、既存ユーザーの承認フロー
- **関連実装**:
    - `src/components/environments/InviteApproval/index.tsx`
    - `src/components/organisms/AccountCreationForm.tsx`

---

## 9. 招待承認機能 (/invite-approval)

### 基本情報

- **URL**: `/invite-approval?token={token}`
- **コンポーネント**: `src/components/environments/InviteApproval/`
- **機能概要**: メールで送付された招待リンク（トークン付き）をクリックした際のランディングページ。トークンを検証し、新規ユーザーなら登録フォームへ、既存ユーザーならログイン/承認画面へ誘導する。

### テスト項目

### 1. トークン検証機能テスト (TOKEN)

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| INV-TOKEN-001 | 無効なトークン | トークンなし、または無効なトークンでアクセス。<br>URL: `/invite-approval?token=invalid` | エラーメッセージ「承認トークンが無効です」等の警告が表示されること。 |  |  |  |
| INV-TOKEN-002 | 有効なトークン（新規） | 未登録メールアドレス宛の有効な招待リンクトークンでアクセス。 | **新規アカウント作成画面**が表示されること。<br>メールアドレス欄がプリセットされ、組織名・テナント名・ロールが表示されること。 |  |  |  |
| INV-TOKEN-003 | 有効なトークン（既存） | 既に登録済みのメールアドレス宛の有効な招待リンクトークンでアクセス。 | `/approve` ページへリダイレクトされること。 |  |  |  |

### 2. アカウント作成フロー (NEW-USER)

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| INV-NEW-001 | 必須項目入力 | 名前、パスワード（確認含む）を入力して「アカウント作成」をクリック。 | 処理が成功し、「アカウント作成完了」画面（またはメール確認案内）が表示されること。 |  |  |  |
| INV-NEW-002 | バリデーション | パスワード不一致や強度不足で送信。 | エラーメッセージが表示され、送信できないこと。 |  |  |  |

### 3. ログイン済みユーザーフロー (EXISTING-USER)

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| INV-LOGIN-001 | ログイン済みアクセス | 既にログインしている状態で招待リンクにアクセス。 | `/approve` へリダイレクトされ、スムーズに組織参加承認プロセスへ進むこと。 |  |  |  |

---

## テスト環境情報

- **テスト環境 URL**: [https://staging.follot-biz.com](https://staging.follot-biz.com/)
- **テストアカウント**: 新規招待用メールアドレス（未登録）、既存アカウント
- **ブラウザ**: Chrome 最新版、Safari 最新版、Edge 最新版