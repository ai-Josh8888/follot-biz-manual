# 【テスト仕様書】通知管理機能

## 本情報

- **作成日**: 2025 年 12 月 23 日
- **対象バージョン**: リリース前最終版
- **テスト対象**: 通知の一覧表示、フィルタリング、既読管理、バッジ連携
- **関連実装**:
    - `src/components/environments/NotificationManager/index.tsx`
    - `src/components/ecosystems/Sidebar2/Notification.tsx`
    - `src/components/ecosystems/Notification/content/index.tsx`
    - `src/contexts/NotificationManagerContext.tsx`
    - `src/contexts/NotificationBadgeContext.tsx`

---

## 4. 通知管理機能 (/notifications)

### 基本情報

- **URL**: `/notifications`
- **コンポーネント**: `src/components/environments/NotificationManager/`
- **機能概要**: システム内の各種イベント（チャット受信、タスクアサイン等）の通知を一元管理する機能。カテゴリ別のフィルタリングや既読状態の管理を行う。

### データ構造

- **Notification**:
    - `id`: string - 通知 ID
    - `category`: enum - カテゴリ (workChat, task, aiChat, businessChat, information)
    - `title`: string - 通知タイトル
    - `content`: string - 通知内容
    - `read`: boolean - 既読フラグ
    - `link`: string - 遷移先 URL
    - `createdAt`: date - 作成日時

### テスト項目

### 1. UI 表示テスト (UI)

| 項目 ID | 確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| NOTIF-UI-001 | ページアクセス | ヘッダー「通知管理」、サイドバー（カテゴリ一覧）、通知一覧が表示されること。<br>URL: `/notifications` | 井上文 | 2025/12/25 | △ | [【仕様確認】NOTIF-UI-001:ヘッダー「通知管理」　と規定されているが、実際のFB画面では「通知一覧」と記載されている](https://www.notion.so/NOTIF-UI-001-FB-2d477fe36e8280498118d259234892f1?pvs=21) |
| NOTIF-UI-002 | サイドバー項目 | デフォルトで「全通知」「information」が表示されること。<br>権限に応じて「Team チャット」「タスク」「AI チャット」「Biz トーク」が表示されること。 | 井上文 | 2025/12/25 | △ | 現状だと[権限:Teamチャットゲスト]のみデフォルトの2つ+「Teamチャット」が表示されている

[権限:ユーザー]以上だと全て出ている

この状態が正しいか左記だけでは不明 |
| NOTIF-UI-003 | 通知一覧表示 | 未読/既読の通知がリスト形式で表示されること。<br>未読通知は強調表示（太字や背景色等）されていること。 | 井上文 | 2025/12/25 | 〇 | 太字対応　背景は変わらない |
| NOTIF-UI-004 | バッジ表示 | サイドバーの各カテゴリ横に未読件数のバッジが表示されること。<br>（未読がある場合のみ） | 井上文 | 2025/12/25 | △ | [サイドバーではなくナビアイコンだと思われる](https://docs.google.com/presentation/d/1QAh38qgWGk4wSzhaseqUCqd9v4J1ZHxq6T31Q-ShWiU/edit?pli=1&slide=id.g279a1eeb6aa_0_0#slide=id.g279a1eeb6aa_0_0)

サイドバーには未読件数のバッジはない |

### 2. 機能テスト (FUNC)

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| NOTIF-FUNC-001 | 全通知表示 | サイドバー「全通知」をクリック。<br>【期待動作】<br>・全てのカテゴリの通知が表示されること。 | 井上文 | 2025/12/25 | 〇 |  |
| NOTIF-FUNC-002 | カテゴリフィルタ | サイドバー「Team チャット」をクリック。<br>【期待動作】<br>・「Team チャット」に関連する通知のみが表示されること。<br>・URL パラメータに `?category=workChat` が付与されること。 | 井上文 | 2025/12/25 | 〇 |  |
| NOTIF-FUNC-003 | 既読処理 | 未読の通知をクリックして詳細を表示（またはリスト上で既読化操作）。<br>【期待動作】<br>・対象通知が「既読」状態になること（見た目の変化）。<br>・サイドバーの未読バッジのカウントが 1 減ること。<br>・ブラウザタブのファビコンバッジが更新されること（全既読なら消える）。 | 井上文 | 2025/12/25 | 〇 | [【提案】通知：チェックボックスを利用した一括操作に「全て既読にする」を追加](https://www.notion.so/2d477fe36e8280938f19c7d55b000e9f?pvs=21) |
| NOTIF-FUNC-004 | ページネーション | 通知が多数ある場合、スクロールまたは「もっと見る」で追加読み込みができること。 | 井上文 | 2025/12/25 | 〇 | ✕：もっと見る
〇：続きを表示 |
| NOTIF-FUNC-005 | 関連ページ遷移 | 通知をクリック。<br>【期待動作】<br>・通知に関連するページ（例：該当のチャットルームやタスク詳細）へ遷移すること。<br>・遷移と同時に既読になること（実装依存だが確認）。 | 井上文 | 2025/12/25 | 〇 |  |

### 3. 権限・表示制御テスト (AUTH)

| 項目 ID | 確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| NOTIF-AUTH-001 | 権限による表示 | 「Team チャット」の権限を持たないユーザーでログイン。<br>【期待動作】<br>・サイドバーに「Team チャット」の項目が表示されないこと。 |  |  |  |  |
| NOTIF-AUTH-002 | テナント未選択 | テナント未選択状態でアクセス。<br>【期待動作】<br>・テナント選択画面 (`/tenant-select`) へリダイレクトされること。 |  |  |  |  |

---

## テスト環境情報

- **テスト環境 URL**: [https://staging.follot-biz.com](https://staging.follot-biz.com/)
- **テストアカウント**: 別途共有
- **ブラウザ**: Chrome 最新版、Safari 最新版、Edge 最新版