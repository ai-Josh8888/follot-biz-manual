# 【テスト仕様書】タスク管理機能

## 基本情報

- **作成日**: 2025 年 12 月 23 日
- **対象バージョン**: リリース前最終版
- **テスト対象**: タスクの作成、編集、削除、一覧表示、フィルタリング機能
- **関連実装**:
    - `src/components/environments/TaskManager/index.tsx`
    - `src/components/ecosystems/Task/content/index.tsx`
    - `src/components/ecosystems/Task/form/index.tsx`
    - `src/components/ecosystems/Sidebar2/Task.tsx`

---

## 3. タスク管理機能 (/tasks)

### 基本情報

- **URL**: `/tasks`
- **コンポーネント**: `src/components/environments/TaskManager/`
- **機能概要**: タスクのライフサイクル管理（作成、割当、進捗管理、完了）を行う機能。サイドバーによるフィルタリングが特徴。

### データ構造

- **Task**:
    - `title`: string - タイトル（必須）
    - `status`: enum - ステータス (未対応, 対応中, 完了, 保留)
    - `priority`: enum - 優先度 (高, 中, 低)
    - `supervisor`: object - 担当者
    - `author`: object - 作成者
    - `startDate`: date - 開始日
    - `endDate`: date - 終了日（Sentinel Value: 未設定時は 9999-12-31）
    - `content`: string - 内容
    - `source`: enum - 関連元 (Task, WorkChat, BusinessChat, Customer) ※動的計算
    - `channel`: object - 関連ルーム情報
    - `files`: array - 添付・画像
    - `createdAt`: date - 登録日
    - `updatedAt`: date - 更新日
    - **非正規化フィールド（Phase 2 追加）**:
        - `relatedUsers`: string[] - 閲覧可能ユーザーID配列（channel.users + [supervisor.id](http://supervisor.id/) + [author.id](http://author.id/)）
        - `channelMode`: string - チャンネルモード（channel/dm）
        - `channelCustomerIds`: string[] - 関連顧客ID配列
        - `isBizTask`: boolean - bizトークルーム進捗タスク判定

### テスト項目

### 1. UI 表示テスト (UI)

| 項目 ID | 確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| TASK-UI-001 | ページアクセス | ヘッダー「タスク」、サイドバー（フィルタ一覧）、タスク一覧が表示される | 井上文 | 2026/01/15 | 〇 |  |
| TASK-UI-002 | サイドバー項目 | 全タスク、作成タスク、担当タスク、関連ルームタスク、完了タスク等の項目が表示される | 井上文 | 2026/01/15 | 〇 | 「～等」とあるが、挙げられたものしかない |
| TASK-UI-003 | 新規登録ボタン | サイドバー上部に「タスク新規作成」ボタンが表示される | 井上文 | 2026/01/15 | 〇 |  |
| TASK-UI-004 | 一覧表示 | 登録済みタスクがテーブル形式で表示される（タイトル、ステータス、優先度、担当者、登録日、期日） | 井上文 | 2026/01/15 | 〇 |  |

### 2. 機能テスト (FUNC)

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| TASK-FUNC-001 | 新規作成モーダル表示 | 「タスク新規作成」をクリックすると、入力フォーム（タイトル、担当者、期限等）を持つモーダルが表示される | 井上文 | 2026/01/15 | 〇 |  |
| TASK-FUNC-002 | 新規タスク作成 | 必須項目（タイトル）を入力し「作成」をクリックすると、タスクが作成され一覧に追加される | 井上文 | 2026/01/15 | 〇 |  |
| TASK-FUNC-003 | ファイル添付 | 作成/編集フォームで画像をアップロードし、プレビューが表示され、保存できる | 井上文 | 2026/01/15 | △ | 登録された画像が小さく表示はされるが、クリックして拡大したりは出来ない

「タスク」という仕様上、拡大プレビューやDL出来ないのは多分よくない |
| TASK-FUNC-004 | タスク編集 | 一覧のタスクをクリック（または編集ボタン）し、内容を変更して「更新」すると反映される | 井上文 | 2026/01/15 | 〇 |  |
| TASK-FUNC-005 | タスク完了 | ステータスを「完了」に変更して保存すると、一覧（未完了フィルタ適用時）から消える | 井上文 | 2026/01/15 | 〇 |  |
| TASK-FUNC-006 | タスク削除 | 編集モーダル内の「削除」ボタンをクリックし、承認するとタスクが削除される | 井上文 | 2026/01/15 | 〇 |  |
| TASK-FUNC-007 | 日付設定 | 開始日・終了日をカレンダーから選択し、正しく保存される | 井上文 | 2026/01/15 | 〇 |  |
| TASK-FUNC-008 | 所属・ルーム設定 | 「所属」を選択し、関連する「ルーム」を選択してタスクを作成できる | 井上文 | 2026/01/15 | ✕ | 所属に「ルーム」が存在しない |
| TASK-FUNC-009 | 編集時の登録日表示 | タスク編集モーダルの下部に「登録日」が編集不可で表示される（新規作成時は非表示） | 井上文 | 2026/01/15 | 〇 |  |
| TASK-FUNC-010 | ソート機能 | 並べ替えドロップダウンから選択すると一覧が指定順でソートされる（期限が近い順、登録日新しい順/古い順、タイトル順、ステータス順、優先度順） | 井上文 | 2026/01/15 | 〇 |  |
| TASK-FUNC-011 | フィルター機能 | フィルターパネルでステータス、優先度、担当者、タスク登録日、ルーム、顧客を指定して絞り込みができる | 井上文 | 2026/01/15 | ✕ | 「全タスク」でフィルターをかけた際にはある程度機能しているが、「担当タスク」枠でフィルターをかけると機能していない
[１](https://www.notion.so/BUG-2d577fe36e828009bcfbce96a4e3cc94?pvs=21)・[２](https://www.notion.so/BUG-2e977fe36e8280e9a7eaedb9ead0de75?pvs=21) |
| TASK-FUNC-012 | 編集後のソート維持 | タスク編集・削除後、現在のソート・フィルター条件を維持して一覧が再表示される | 井上文 | 2026/01/15 | △ | 「全タスク」では挙動確認〇
他は未確認 |

### 3. フィルタリング・ナビゲーションテスト (NAV)

| 項目 ID | 操作 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| TASK-NAV-001 | 全タスク表示 | サイドバー「全タスク」をクリック。URL: `/tasks`。<br>【期待動作】<br>・全てのタスクが表示されること。 |  |  |  |  |
| TASK-NAV-002 | 作成タスクフィルタ | サイドバー「作成タスク」をクリック。<br>【期待動作】<br>・「作成者」が自分であるタスクのみが表示されること。 |  |  |  |  |
| TASK-NAV-003 | 担当タスクフィルタ | サイドバー「担当タスク」をクリック。<br>【期待動作】<br>・「担当者」に自分が設定されているタスクのみが表示されること。 |  |  |  |  |
| TASK-NAV-004 | 完了タスク表示 | サイドバー「完了タスク」をクリック。<br>【期待動作】<br>・ステータスが「完了」のタスクのみが表示されること。<br>・（通常の一覧では完了タスクは表示されないため、ここで確認する） |  |  |  |  |
| TASK-NAV-005 | 関連ルームタスク | サイドバー「関連ルームタスク」をクリック。<br>【期待動作】<br>・「グループチャット」（Biz トークや Team チャットのルーム）で作成されたタスクが表示されること。<br>・「ダイレクトメッセージ(DM)」で作成されたタスクは**表示されない**こと。<br>・ルームに紐付かない（タスク管理画面で作成時に所属を指定しなかった）タスクは**表示されない**こと。 |  |  |  |  |
| TASK-NAV-006 | 関連 DM タスク | サイドバー「関連 DM タスク」をクリック。<br>【期待動作】<br>・「ダイレクトメッセージ(DM)」で作成されたタスクのみが表示されること。<br>・「グループチャット」で作成されたタスクは**表示されない**こと。 |  |  |  |  |
| TASK-NAV-007 | ルーム進捗 | サイドバー「ルーム進捗」をクリック。<br>【期待動作】<br>・Biz トーク（顧客ルーム）の「案件進捗タスク」のみが表示されること。<br>・個別のチャットメッセージから作成したタスクは**表示されない**こと。<br>・Team チャットのタスクは**表示されない**こと。<br>※「案件進捗タスク」とは、その顧客ルームの進捗管理用として作成された、メッセージに紐付かないタスクを指します。 |  |  |  |  |

### 4. バリデーションテスト (VAL)

| 項目 ID | 入力値 | 操作 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| TASK-VAL-001 | タイトル空欄 | 新規作成/更新 | 「必須入力項目です」等のエラーが表示され、保存できない |  |  |  |  |
| TASK-VAL-002 | ファイル数超過 | 4 枚以上の画像を添付しようとする | エラーが表示される、または選択できない |  |  |  |  |
| TASK-VAL-003 | ファイル形式不正 | 画像・PDF・ZIP 以外を選択 | エラーが表示される |  |  |  |  |

### 5. 権限・データ整合性テスト (DATA/AUTH)

| 項目 ID | 確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| TASK-DATA-001 | 作成者表示 | タスク詳細・編集画面で「作成者」フィールドに正しいユーザー名が表示され、変更不可となっている |  |  |  |  |
| TASK-AUTH-001 | 他人のタスク | 他人が作成・担当しているタスクの閲覧・編集が可能かを確認（仕様によるが、基本は共有される） |  |  |  |  |

---

## テスト環境情報

- **テスト環境 URL**: [https://staging.follot-biz.com](https://staging.follot-biz.com/)
- **テストアカウント**: 別途共有
- **ブラウザ**: Chrome 最新版、Safari 最新版、Edge 最新版