---
title: AI機能（テスト仕様書）
---

## 原文（テスト仕様書）

以下は元のテスト仕様書の内容です。


```markdown
# AI機能

# 【テスト仕様書】AI機能

## 基本情報

- **作成日**: 2025年8月6日
- **対象バージョン**: リリース前最終版
- **テスト対象**: AI機能全般（プロンプト管理、AIチャット）

---

## 4. AI機能 (/ai)

### 基本情報

- **URL**: `/ai`, `/ai/chat`
- **コンポーネント**: `src/components/environments/Ai/`, `src/components/ecosystems/AiPrompt/`
- **機能概要**: AIとの対話を行うチャット機能と、その対話や他のチャットで利用するプロンプトテンプレートを管理する機能。

### テスト項目

### 4.1 プロンプト管理機能テスト (/ai)

| 項目ID | 操作 | 期待結果 | 実施者 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- |
| AI-MAN-001 | プロンプト管理画面にアクセスする | 作成済みのプロンプトテンプレートがテーブル形式で一覧表示されること。「新規作成」ボタンが表示されること。 | 25/10/27　井上文 | 〇 | `AiPromptTable` |
| AI-MAN-002 | 「新規作成」→「次へ」をクリック | プロンプトの基本設定後、「次へ」を押すと、左に「質問」、右に「プロンプトコード」を配置した編集画面に遷移すること。 | 25/10/27　井上文 | 〇 | `CodePage` |
| AI-MAN-003 | **質問の追加**（自由入力） | 「質問を追加する」→「自由入力」を押し、質問文などを設定して保存すると、質問リストに追加されること。 | 25/10/27　井上文 | 〇 | `QuestionPage` |
| AI-MAN-004 | **質問の追加**（単一選択） | 「単一選択」で質問と複数の選択肢（表示名/挿入値）を設定・保存すると、質問リストに追加されること。 |  |  | `QuestionPage` |
| AI-MAN-005 | **質問リストの操作**（挿入） | 質問リストの「挿入」ボタンを押すと、対応する変数（`%%input...%%`）が右側のプロンプトコードのカーソル位置に挿入されること。 |  |  | `CodePage` |
| AI-MAN-006 | **質問リストの操作**（編集・削除） | 既存の質問を「編集」できること。また、「削除」するとリストから消え、コード内の対応変数も自動で削除されること。 |  |  | `QuestionPage` |
| AI-MAN-007 | **プロンプトコードの編集** | 右側のテキストエリアで、プロンプトのテンプレート文章を直接編集・保存できること。 |  |  | `CodePage` |
| AI-MAN-008 | **表示設定・ステータス**の設定 | 最初のページで「表示設定」（自分のみ/テナント内など）や「ステータス」（下書き/完成など）を設定・保存できること。 |  |  | `PromptPage` |
| AI-MAN-009 | **優先表示**の設定と警告 | 「優先表示」で利用シーン（Workチャットなど）を選択できること。表示条件を満たさない設定の場合、警告メッセージが表示されること。 |  |  | `PromptPage` |

### 4.2 AIチャット機能テスト (/ai/chat)

| 項目ID | 操作 | 期待結果 | 実施者 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- |
| AI-CHAT-001 | AIチャット画面にアクセスする | AIとの対話用のチャットUIが表示されること。 |  |  | `AiChat` |
| AI-CHAT-002 | メッセージを送信する | 送信したメッセージ（プロンプト）に対するAIの応答が、新しいメッセージとしてリアルタイムで表示されること。 |  |  | `AiChat` |
| AI-CHAT-003 | 過去の対話履歴の確認 | 画面を再読み込みしたり、再度アクセスしたりしても、過去のAIとの対話履歴が保持されていること。 |  |  | `AiChat` |

### 4.3 外部連携・プロンプト実行テスト

| 項目ID | 操作 | 期待結果 | 実施者 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- |
| AI-INT-001 | **Workチャット**のフォームで「AI」ボタンをクリック | `/ai`で作成・設定したプロンプトのうち、「優先表示: Workチャット」かつ表示条件を満たすものだけがポップオーバーに表示されること。 |  |  | `MessageForm`との連携 |
| AI-INT-002 | **Bizトーク**のフォームで「AI」ボタンをクリック | 「優先表示: Bizトーク」かつ表示条件を満たすプロンプトのみが表示されること。 |  |  | `MessageForm`との連携 |
| AI-INT-003 | プロンプトを選択する（変数入力） | ポップオーバーからプロンプトを選択すると、実行用モーダルが表示される。プロンプトに設定した「質問」が、自由入力欄や選択肢として表示されること。 |  |  | `AiPromptInstanceForm`, `InputPage` |
| AI-INT-004 | プロンプトを実行し、結果を挿入する | 質問に回答・選択して実行すると、AIの生成結果が表示され、「挿入」ボタンを押すと元のチャットのメッセージ入力欄にテキストが挿入されること。 |  |  | `AiResponsePage`, `setInsertedMessage` |
| AI-INT-005 | 優先表示条件外のプロンプトの確認 | 「優先表示」にチェックを入れても、ステータスが「非公開」などの条件を満たさないプロンプトが、チャットのAIメニューに表示されないこと。 |  |  | `MessageForm` |

### 4.4 権限テスト

| 項目ID | ユーザーロール | 操作/確認箇所 | 期待結果 | 実施者 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| AI-AUTH-001 | **ユーザー** (`User`) | プロンプトの作成 | 自身が利用するためのプロンプトを作成できること。 |  |  |  |
| AI-AUTH-002 | **ユーザー** (`User`) | プロンプトの編集・削除 | 自身が作成したプロンプトのみ編集・削除が可能であること。他ユーザー作成のプロンプトは閲覧のみ可能。 |  |  |  |
| AI-AUTH-003 | **運用管理者** (`Manager`) | プロンプトの編集・削除 | テナント内の全ユーザーが作成したプロンプトを編集・削除できること。 |  |  |  |
| AI-AUTH-004 | **ユーザー** (`User`) | 「表示設定」フォーム | 「クーバル権限用」の選択肢が表示されないこと。 |  |  | `aiPrompt:setReferencePrompt`権限 |
| AI-AUTH-005 | **クーバル権限** (`isSuperAdmin: true`) | プロンプトの全操作 | すべてのプロンプトの作成・編集・削除が無条件に可能であること。「表示設定」で「クーバル権限用」も選択可能であること。 |  |  | `isSuperAdmin`フラグ |
| AI-AUTH-006 | **権限なしユーザー** | プロンプト管理画面へのアクセス | `/ai`にアクセスした場合、権限がない旨のメッセージが表示され、機能が利用できないこと。 |  |  | `usePermission` |
```
