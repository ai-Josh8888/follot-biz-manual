# タスク一覧機能（サーバーサイドページネーション）

## 1. 基本情報

- **作成日**: 2025 年 12 月 22 日
- **対象バージョン**: リリース前最終版
- **テスト対象**: タスク一覧のサーバーサイドページネーション機能およびクライアントモード機能
- **関連実装**:
    - src/components/ecosystems/Task/TaskTable/index-loadMore.tsx
    - src/hooks/useTask.ts
    - src/core/repositories/taskRepository.ts

## 2. 機能ごとのセクション

### 基本情報

- **URL**: /tasks (タスク一覧画面)
- **コンポーネント**: src/components/ecosystems/Task/TaskTable/
- **機能概要**: タスクリストのサーバーサイドページネーション表示。特定の検索条件下ではクライアントモード（全件取得＋クライアント側ページネーション）に切り替わる。

## 3. テスト項目

### 機能テスト (FUNC) - サーバーサイドモード

### UI 表示テスト (UI)

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| TK-UI-001 | 初期表示（フィルタなし） | 最新の 20 件が表示され、リスト下部に「続きを読む」ボタンが表示されること。 | 井上文 | 2025/12/26 | 〇 | [【BUG？】タスク：20件の中にタイトルが長文のものがあると各枠のサイズ感が変わってしまう](https://www.notion.so/BUG-20-2d577fe36e828092b308d6b59b9b3267?pvs=21) |
| TK-UI-002 | 件数表示の確認 | 画面上部のタスク件数がサーバー上のタスク総数と一致していること。（※サーバーサイドモード時） | 井上文 | 2025/12/26 | 〇 | 総数88件＝[続きを読む]を3回押下→4回目の押下で追加されたのが8件 |

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| TK-FUNC-001 | 追加読み込み（もっと見る） | ボタン押下で次の 20 件がロードされ、リストに追加されること。 | 井上文 | 2025/12/26 | 〇 |  |
| TK-FUNC-002 | 完了フィルタ適用（デフォルトは未完了） | 「完了」ステータスを選択するとリストがリセットされ、完了タスクが最新 20 件表示されること。 | 井上文 | 2025/12/26 | 〇 |  |
| TK-FUNC-003 | 担当者フィルタ適用 | 特定の担当者を選択するとリストがリセットされ、該当タスクが最新 20 件表示されること。 | 井上文 | 2025/12/26 | 〇 |  |
| TK-FUNC-005 | ルームフィルタ適用 | 特定のルームを選択するとリストがリセットされ、そのルームに関連するタスクが表示されること。 | 井上文 | 2025/12/26 | ✕ | [【BUG】タスク-検索フィルタ：[ルームフィルタ]が機能していない可能性がある](https://www.notion.so/BUG-2d577fe36e828009bcfbce96a4e3cc94?pvs=21) |
| TK-FUNC-006 | 顧客フィルタ適用 | 特定の顧客を選択するとリストがリセットされ、その顧客に関連するタスクが表示されること。 | 井上文 | 2025/12/26 | ✕ | [【BUG】タスク：顧客フィルタに表示される顧客の数に限度がある](https://www.notion.so/BUG-2d577fe36e828028847bfec2898de0b8?pvs=21) |
| TK-FUNC-007 | 日付フィルタ適用 | 指定した期間内のタスクが表示されること（※内部的には更新日でフィルタリング）。 | 井上文 | 2025/12/26 | ✕ |  |
| TK-FUNC-008 | ソート変更（優先度） | 「優先度順」に変更すると、リストがリセットされ、優先度順で表示されること。 | 井上文 | 2026/01/05 | 〇？ | 今すぐ＞急いで＞高め＞通常＞低め＞未確定

[【疑問+BUG】TK-FUNC-001～008のタスクフィルタ/ソートの流れについて](https://www.notion.so/BUG-TK-FUNC-001-008-2df77fe36e8280fbbc24ddbed5f65fee?pvs=21) |
| TK-FUNC-009 | タスク削除 | リスト上のタスクを削除すると、即座にリストから消え、件数表示が-1 されること（Optimistic Update）。 | 井上文 | 2026/01/05 | 〇 |  |

### 機能テスト (FUNC) - サイドバー遷移（プリセットフィルタ）

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| TK-FUNC-020 | 全タスク | 「全タスク」をクリック。全タスク一覧が表示されること（フィルタ解除状態）。 | 井上文 | 2026/01/05 | 〇 |  |
| TK-FUNC-021 | 作成タスク | 「作成タスク」をクリック。ログインユーザーが作成したタスクのみが表示されること。 | 井上文 | 2026/01/05 | 〇 |  |
| TK-FUNC-022 | 担当タスク | 「担当タスク」をクリック。ログインユーザーが担当者のタスクのみが表示されること。 | 井上文 | 2026/01/05 | 〇 |  |
| TK-FUNC-023 | 関連ルームタスク | 「関連ルームタスク」をクリック。ルーム（チャット）に関連するタスクのみが表示されること。 | 井上文 | 2026/01/07 | 〇 | [【BUG？】タスク：[関連ルームタスク]に振り分けられたタスクの中にAIチャットで生成したタスクが含まれる](https://www.notion.so/BUG-AI-2e177fe36e8280669a56fcba0c067931?pvs=21)

[【BUG】タスク：AIチャットのチャット欄で生成したタスクの場合、タスク一覧>タスク詳細内の[ルーム]で該当のAIチャット欄に遷移しようとすると404エラーページが表示される](https://www.notion.so/BUG-AI-AI-404-2e177fe36e82804ea72fdeab1f07f9c0?pvs=21) |
| TK-FUNC-024 | 関連 DM タスク | 「関連 DM タスク」をクリック。DM に関連するタスクのみが表示されること。 | 井上文 | 2026/01/08 | 〇 | 暫く使っているユーザーアカウントでここに振り分けられたタスクがなかった

ユーザー権限アカウントからDMのチャット欄でタスク依頼したところ、こちらに振り分けられるタスクとなった

現状はこれだけ確認できれば良いかと考えている |
| TK-FUNC-025 | ルーム進捗 | 「ルーム進捗」をクリック。ルーム進捗に関連するタスクが表示されること（`isBizTask=1`）。 | 井上文 | 2026/01/08 | 〇 | Bizトークのサイドバーに並ぶルーム名の横のアイコンから依頼した際のタスクがここに並ぶ

[逆に上記で生成されたものは「全タスク」にもカウントされない仕様となっている](https://www.notion.so/BUG-26b77fe36e8280b19281e5ac33a99c15?pvs=21) |
| TK-FUNC-026 | 完了タスク | 「完了タスク」をクリック。ステータスが「完了」のタスクのみが表示されること。 | 井上文 | 2026/01/08 | 〇 | クローズは含まれない |

### 機能テスト (FUNC) - クライアントモード（全件取得＋クライアントページネーション）

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| TK-FUNC-010 | キーワード検索実行（例: "テスト"） | 検索実行時、該当する全タスクが読み込まれる。最初は 20 件表示され、「続きを読む」ボタン押下で次の 20 件が表示される（クライアント側ページネーション）こと。 | 井上文 | 2026/01/08 | 〇 | タイトルだけでなく、内容説明のテキストに入っている文字も検索していることを確認

また[続きを読む]機能も確認 |
| TK-FUNC-012 | 検索条件クリア | 検索欄をクリアすると、再度サーバーサイドモード（最新 20 件表示＋サーバーサイドページネーション追加）に戻ること。 | 井上文 | 2026/01/08 | △ | 「検索欄をクリアする機能を作る」的な話だった気がするが、そちらの実装はまだない

とりあえず検索したワードを手動で消して、再度検索をかける事で検索以前の状態に戻せる |

### 機能テスト (FUNC) - サーバーサイドモード（ソート）

| 項目 ID | 操作/確認内容 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- |
| TK-FUNC-011 | 期限日ソート実行 | 「期限日順」に変更すると、サーバーサイドでソートされ、20 件ずつ表示（続きを読むボタンで追加表示）されること。期限未設定タスクは末尾に表示される。 | 井上文 | 2026/01/08 | 〇 | 「期限日の日付が古い順」に上位に来るので期限日が過去であっても表示される

期限日が過去の場合は何かしらアイコンなりが出ても良い気はする |

### 権限テスト (AUTH)

| 項目 ID | ユーザーロール | 操作/確認箇所 | 期待結果 | 実施者 | 実施日 | 結果 | 備考 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| TK-AUTH-001 | 運用管理者/一般ユーザー | 他人のタスク表示 | 自身の担当、関連するチャットに関連するタスクのみが表示される（または仕様依存の表示制限に従う）こと。 | 井上文 | 2026/01/08 | 〇 | [権限:ユーザー]アカウントと[クーバル管理/管理者権限]アカウントで[全タスク]のカウントを比べると差があるので、
「>自身の担当、関連するチャットに関連するタスクのみが表示される」という機構は働いているように思う

 |